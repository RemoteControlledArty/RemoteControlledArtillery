/*
	TO DO / DONE LIST
*/


TO DO - BUGFIXES:

-does it still need include check for ace hpp?
-if arty is destroyed, ui stays...?
-crl+h cuts connection and destroys UV?
-ar2 problems on server, is it due to some of the scripts, or a server issue?
-turret is locked unable to adjust up/down, when scope of player is adjustable...
-HEAB with aimabovetarget explodes too early with negative gun elevation, or low charge direct fire... *maybe swap to normal HE magazines per script when turret has negative elevation
-RC Recon RADAR activated by default to make it actually usefull (works when deleting commander and activating it manual, or human ai is in there, not with uav ai even with https://community.bistudio.com/wiki/setVehicleRadar)


TO DO - FEATURES:

documentation:
-add new assets to cfg patches list
-add showAllTargets = 4; //LockLaser, show only targets from laser spot tracker (laserScanner); since Arma 3 1.60

arty:
-double check LaserDatalink code
-using multiguided without selecting target and looking at terrain, can cause automatic targeting of friendly UV's?
-add datalink & laser firing solution display
-add low trajectory TOP DOWN formula & display for when multiguided is used (low firing solution + 200meter height)
-datalink selected target speed display near firing solution, to decide if it makes sence to fire

-improve 227mm explosion effect
-edit 	aiRateOfFire=1;   aiRateOfFireDistance=10;
-increase precision of 227mm guided when engaging laser
-warheadName HE/TandemHEAT ?
-recon radar mortar carrier composition, needs:
	-low angle mortar without disassemle/backpack/arsenal
	-script to hide legs
	*addweapon sadly wont work on uneven surface as projectile leaves barrel aligned

-remove non airburst HE after trajectory testing
-low/high trajectory list:
	low: HEAB, Guided
	low top down: Guided
	high: Cluster, Smoke, AT/AP Mines, Illum

-report arty map markers to datalink, to lock for gps guidance, maybe if "gps" is written in the marker name? RC_O_InvisibleDatalinkTarget works, maybe add eventhandler for datalink reporting to it
_laser = laserTarget player;
_targetSolider = "RC_I_InvisibleDatalinkTarget" createVehicle getpos _laser;
side player reportRemoteTarget [_targetSolider, 40];

-how to get position of muzzle? 	gunBeg="Usti hlavne";	gunEnd="Konec hlavne";	https://forums.bohemia.net/forums/topic/220406-universal-way-to-get-any-turrets-direction/
_uav = (getConnectedUAV player);
//_uav selectionPosition ["Konec hlavne", "Memory", "FirstPoint"];
//_uav selectionPosition ["Usti hlavne", "Memory", "FirstPoint"];
//_uav selectionPosition ["Konec hlavne", "Memory", "AveragePoint"];
//_uav selectionPosition ["Konec hlavne", "Memory", "BoundingBox"];

*NOTE to self, marker moving with ctrl+lmb is extremly practical for correcting fire and aiming multiple smokes!
*NOTE to self, AT mines should be deployed about 20m after a unifying crossroad, not on it, due to inaccuracy
*NOTE to self, wood+too few sandbag roof of usual MG/GMG bunkers do luckly not protect against 155mm airburst

general:
-fix Static AT laser engaging (how!?)

RC IC:
-hide seats for RC IC
-attemt to add commander seat to RC IC
-if hull and engine is red then remove AI until repaired, so it doesnt keep getting engaged
-improve driver view (to camera if possible)
-fix or remove datalink panel
-decrease oversteering

RC Respawn Truck (not priority, can be post update):
-add more versions
-edit hitpoints
-lock seats
-add respawn script

NLOS FSV:
-remove gunner&commander script
-find a way to lock seats depending on current seat
-update NLOS sounds
-top town only for DLG

AR-short:
-making sure effect is reset when leaving uav
-remove thermal from AR1 or try to change ppeffect priority

_uav = getConnectedUAV player;
_viewPos = screenToWorld [0.5, 0.5];
_uavPos = getpos _uav;
_distance = _viewPos distance _uavPos;
hintSilent format ["distance: %1", _distance];

KK_fnc_trueZoom = {(([0.5,0.5] distance2D  worldToScreen positionCameraToWorld [0,3,4]) * (getResolution select 5) / 2)};

while {true} do
{ 
	_uavPos = getpos (getConnectedUAV player);
	_playerPos = getpos player;
	_viewPos = screenToWorld [0.5, 0.5];
	
	//_playerDistance = _uavPos distance _playerPos;
	//_viewDistance = _uavPos distance _viewPos;
	_viewDistance = _playerPos distance _viewPos;  
	
	_zoomBlur = (round (call KK_fnc_trueZoom * 10) / 10)*0.04;
	//_connection = 1+(_distance * 0.0008)^5;
	//_connectionBlur = 1;
	_viewBlur = 1;
	//if (_playerDistance >= 1000) then {_connectionBlur = 1+((_playerDistance-1000) * 0.005)^4};
	if (_viewDistance >= 1000) then {_viewBlur = 1+((_viewDistance-1000) * 0.0035)^4};
	//_finalBlur = 1;
	_finalBlur = 0.1 * _viewBlur * _zoomBlur;
	//hintSilent format ["distance: %1", _distance];
	hintSilent format ["blur: %1", _finalBlur];
	
	
	_blur = ppEffectCreate ["dynamicBlur", 401];
	_blur ppEffectEnable true;
	_blur ppEffectAdjust [_finalBlur];
	_blur ppEffectCommit 0;
};



TO DO - QUALITY OF LIFE:

-test uav connection fix in editor with its new location
-only disable driver = 4, for modularity
-maybe turret azimuth lock hotkey, for when changing EL on uneven ground throws it off

-get missle feed panel to connect to missle

-magazine shell count attributes code? (Who wrote this, what is meant by it?)




IDEAS - FAR FUTURE:

-disconnect uav/ugv from terminal script when vanilla incapacitated / ace unconcious

-AR-0.5 and AL-7 for pvp, with 1.5 zoom to force low flying, shortrange sensors, no thermal, but laser designator
-RC Marid with upgraded engines 7.62x51 and smoke GL

-test passive radar shells against active radar AA

-direct fire firing solution (camera viewpoint)
-yellow 10m radius for Azimuth&GunEL, for fire adjustments
-maybe add max spread display / hit propability display (HEAB = 30m radius, inaccuracy at marked distance = ? radius, = ? hit probability)

-video partially at night for rocket and explosion effects

-make MLRS/MRL rockets appear in launcher (if possible)
-https://community.bistudio.com/wiki/lockCameraTo  /  https://community.bistudio.com/wiki/enableDirectionStabilization  /  https://community.bistudio.com/wiki/camSetTarget
-azimuth camera lock (marker, laser, selected, off), as uneven surfaces make keeping azimuth aligned problematic
-or atleast hotkey to swing to azimuth *cannot lock directly to direction of target to az changing with uneven ground
-vanilla asset overwrite for gamemodes without zeus etc *maybe by second pbo and config, class RC_Howitzer; class vanilla_Howitzer: vanilla_Howitzer  but likely doesnt work
-switch driver and commander of recon radar
-3R MRSI display
-3R automated MRSI
-parachute cam round for spotting (or simply additional rhs comp mod for hunt ir, maybe with datalink/laser)

-turret elevationmode=3 (switchable between manual and automatic), changing script to low trajectory, and point of aim height instead ground height
-more detailed 120mm damage difference

-getting misslecam panel to work with multiguided
-counterbattery radar, reporting targets to datalink network, with cba settings on detection speed and range
-RC respawn truck script
-RC RHS (HIMARS, M109 etc) to bring back aweness post update


---------------------------------------------------------------------------------------------------------


DONE - BUGFIXES:

-UI fixed on normal UI scale
-lights off, can simply be done by user in the UAV terminal
-Olive Backpack picture background fix
-armor value fixes
-changed to 9.8066 Gravity
-engine turnoff delay exceptions now per cfg value
-if does not camera points in sky (cannot find range), show red warning "raise camera", (accuracy will be way off and submunitions wont deploy otherwise)
-fix radar turrets viewoptics maxhorrotspeed
-fixed distance calculation
-fixed time of flight calculation
-engine turnoff now per cfg value, so it doesnt affect other ugv's
-found cause for sicnificant over/under-shoot, for low trajectory 0.X MIL are indeed needed, otherwise it will show the same solution despite different distance
-greatly improved accuracy by preventing sicnificant over/under-shoot


DONE - FEATURES:

-added 82mm, 120mm, 155mm, 227mm HE Airburst
-added 82mm, 120mm, 155mm Laser Guided 1.8m Delayed Fuse (for use against small bunkers/ hangars/ ammo storage halls) but only available per attributes edit for balancing reasons
-improved spread of cluster and mines
-buffed smoke of 82mm, 120mm, 155mm
-added 82mm AP and AT mines
-40 magazines for all shells
-required low&high turret elevation display + ETA
-if turret azimuth matches target azimuth, turn green
-if charge is correct for target distance, turn green
-if azimuth correct, turret elevation correct "ready to fire"
-warning if camera is pointed not at sky

(new)
-ammunition naming improvements
-added Datalink panel
-added Datalink laser position finder
-added Datalink selected target position finder
-added AR-3 & 4
-added 604mm ATACMS
-added RC Infantry Carrier
-renamed assets for clarity
-155mm dispersion fixed
-more but finer 155mm charges, to have more angle variety, and enough airburst even with low angle solution
-added optional 67km datalink range (max firing range)
-added peak ASL calculation formula
-shortend map marker search time (as its only running during active remote control, and improves quality of life)
-fixed all sensor configs
-added 82mm/120/155mm/227mm MultiGuided (Can in manual fire lock laser and vehicles on Datalink panel. Or in artillery computer fire find laser spots, and hot (per IR) or cold (per Visual) vehicles.)
-reworked 82mm/120/155mm/227mm MultiGuided, to be more accurate and be Multi Target
-reworked Static AT & ATGM, changed ammo from 4 HEAT & 2 HE to new 4 MT (MultiTarget) rounds, Static AT now has more locking options and also SACLOS
-reworked 120mm charges
-multi guided successfully tested to include gps guidance, but so far only when using artillery computer
-artillery weapon edits in steps, so different versions can be chosen V1 until V4
-split shown ELDiff, and ElDiff for used calculation, to not cause errors
-enabled NLOS for locking ATGM
-tweaked AT mine spread
-reworked 120mm, 155mm, 227mm Airburst, to truly explode before impact (instead of being reset 20meters after impact)
-minor change to howitzer max gun elevation for it be able to shoot closer during compound defense
-added RC RespawnTruck & correct driver camera screen with filter
-reworked Laser Guided 2m Delayed Fuse
-added nightvision to RC RespawnTruck driver camera
-done lots of testing and decided on MT MultiGuided visual model
-added LaserDatalink so that handheld LaserDesignators enable reliable use with Artillery, and decreases reliance of UAV's with Datalink
-testing showed that locking MultiGuided to laser target, firing manual, deactivating laser, has 3 practical results:
	if nothing else is close it switches to gps guidance,
	or if enemy vehicles are close it locks on them,
	which is extremly usefull if the ForwardObserver is suppressed and cannot maintain the lase,
	if the laser is reactivated, it relocks if it is close enough to the original point
-improved 227mm explosion and dust effect
-added N/LOS FSV
-fixed Airburst
-added AR1/AR3 backpacks
-improved mine spread
-improved the FOV of N/LOS FSV, and improved its muzzle smoke effect
-added muzzle position estimation formula in the script
-added ammo usage flags for ai
-fixed sound and effects for new artillery ammunition
-added ground dust effect for airburst
-added LOS FSV
-added Datalink Guided Missles for LOS FSV
-added FSV hpp and subcategory
-individualized ground dust radius of airburst for calibers, and increased dust time
-added 105mm for later use (no suited platform yet found)
-updated remove/addmagazine list, and included as txt
-added missle approach warning systems
-changed uav connection script location


DONE - QUALITY OF LIFE:

-lower FOV for better driving now available
-option for shorter map marker search
-if vehicle speed = 0 then engine is turned off
-map now available for all assets!
-significant mod folder and hpp restructure


---------------------------------------------------------------------------------------------------------


Previous Update:

TO DO - BUGFIXES:

-figure out why MRL and sometimes Howitzer shoots left/right if not aligned...


DONE - BUGFIXES:

-remove human crew hpp and hpp include in config
-hasdriver=-1 removed from all vics
-added lockdriver/commander to likely all vics
-all vehicles now steerable again
-target range cut of when 5 digits
-target cycle keybinds (4 is MRS/MLRS charge) change to 3 and 5

-fix RC_ATGM privated
-fix loop when joining server


TO DO - FEATURES:

-HE airburst, 82mm, 120mm, 155mm, 227mm

-magazine shell count attributes code? (Who wrote this, what is meant by it?)
-only disable driver = 4, for modularity

-explain target marker referencing to current subscribers


DONE - FEATURES:

-RCdisableseats= 1 for loacking commander seat  2 for locking driver and commander seat
-isRCarty=1;  as mod friendly check if display should appear
-howitzer can drive in gunner seat
-added target marker referencing, calculation and display

-added 230mm laser guided and AT guided rockets (unclear if they work)

-added 


TO DO - QUALITY OF LIFE:

-light off! esp Recon Nyx

-if vehicle speed = 0 then turn off engine true
-cannot open map with: mortar, MRL, static AA / AT / ATGM, laser des

-if turret azimuth matches target azimuth, turn green
-if charge is correct for target distance, turn green

-improve turret elevation formula, that accounts for elevation difference better


DONE - QUALITY OF LIFE:

-create basic turret elevation formula https://www.desmos.com/calculator/fsya2kyque?lang=de
